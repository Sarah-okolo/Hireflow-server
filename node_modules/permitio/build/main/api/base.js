"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.BaseFactsPermitAPI = exports.BasePermitApi = exports.PermitApiError = void 0;
const axios_1 = __importDefault(require("axios"));
const openapi_1 = require("../openapi");
const base_1 = require("../openapi/base");
const context_1 = require("./context");
class PermitApiError extends Error {
    constructor(message, originalError) {
        super(message);
        this.originalError = originalError;
    }
    get formattedAxiosError() {
        var _a;
        return {
            code: this.originalError.code,
            message: this.message,
            error: (_a = this.originalError.response) === null || _a === void 0 ? void 0 : _a.data,
            status: this.originalError.status,
        };
    }
    get request() {
        return this.originalError.request;
    }
    get response() {
        return this.originalError.response;
    }
}
exports.PermitApiError = PermitApiError;
class BasePermitApi {
    constructor(config, logger) {
        var _a;
        this.config = config;
        this.logger = logger;
        const version = (_a = process.env.npm_package_version) !== null && _a !== void 0 ? _a : 'unknown';
        this.openapiClientConfig = new openapi_1.Configuration({
            basePath: `${this.config.apiUrl}`,
            accessToken: this.config.token,
            baseOptions: {
                headers: {
                    'X-Permit-SDK-Version': `node:${version}`,
                },
            },
        });
        this.scopeApi = new openapi_1.APIKeysApi(this.openapiClientConfig, base_1.BASE_PATH, this.config.axiosInstance);
    }
    /**
     * Sets the API context and permitted access level based on the API key scope.
     */
    async setContextFromApiKey() {
        var _a, _b;
        try {
            this.logger.debug('Fetching api key scope');
            const response = await this.scopeApi.getApiKeyScope();
            if (response.data.organization_id !== undefined && response.data.organization_id !== null) {
                this.config.apiContext._saveApiKeyAccessibleScope(response.data.organization_id, response.data.project_id, response.data.environment_id);
                if (response.data.project_id !== undefined && response.data.project_id !== null) {
                    if (response.data.environment_id !== undefined && response.data.environment_id !== null) {
                        // set environment level context
                        this.logger.debug(`setting: environment-level api context`);
                        this.config.apiContext.setEnvironmentLevelContext(response.data.organization_id, response.data.project_id, response.data.environment_id);
                        return;
                    }
                    // set project level context
                    this.logger.debug(`setting: project-level api context`);
                    this.config.apiContext.setProjectLevelContext(response.data.organization_id, response.data.project_id);
                    return;
                }
                // set org level context
                this.logger.debug(`setting: organization-level api context`);
                this.config.apiContext.setOrganizationLevelContext(response.data.organization_id);
                return;
            }
            throw new context_1.PermitContextError('could not set api context level');
        }
        catch (err) {
            if (axios_1.default.isAxiosError(err)) {
                this.logger.error(`[${(_a = err === null || err === void 0 ? void 0 : err.response) === null || _a === void 0 ? void 0 : _a.status}] permit.api.getApiKeyScope(), err: ${JSON.stringify((_b = err === null || err === void 0 ? void 0 : err.response) === null || _b === void 0 ? void 0 : _b.data)}`);
            }
            throw new context_1.PermitContextError('could not fetch the api key scope in order to set the api context level');
        }
    }
    /**
     * Ensure that the API Key has the necessary permissions to successfully call the API endpoint.
     * Note that this check is not foolproof, and the API may still throw 401.
     * @param requiredAccessLevel The required API Key Access level for the endpoint.
     * @throws PermitContextError If the currently set API key access level does not match the required access level.
     */
    async ensureAccessLevel(requiredAccessLevel) {
        // should only happen once in the lifetime of the SDK
        if (this.config.apiContext.contextLevel === context_1.ApiContextLevel.WAIT_FOR_INIT ||
            this.config.apiContext.permittedAccessLevel === context_1.ApiKeyLevel.WAIT_FOR_INIT) {
            await this.setContextFromApiKey();
        }
        if (requiredAccessLevel !== this.config.apiContext.permittedAccessLevel) {
            if (context_1.API_ACCESS_LEVELS.indexOf(requiredAccessLevel) <
                context_1.API_ACCESS_LEVELS.indexOf(this.config.apiContext.permittedAccessLevel)) {
                throw new context_1.PermitContextError(`You're trying to use an SDK method that requires an API Key with access level: ${requiredAccessLevel}, ` +
                    `however the SDK is running with an API key with level ${this.config.apiContext.permittedAccessLevel}.`);
            }
        }
    }
    /**
     * Ensure that the API context matches the required endpoint context.
     * @param requiredContext The required API context level for the endpoint.
     * @throws PermitContextError If the currently set API context level does not match the required context level.
     */
    async ensureContext(requiredContext) {
        // should only happen once in the lifetime of the SDK
        if (this.config.apiContext.contextLevel === context_1.ApiContextLevel.WAIT_FOR_INIT ||
            this.config.apiContext.permittedAccessLevel === context_1.ApiKeyLevel.WAIT_FOR_INIT) {
            await this.setContextFromApiKey();
        }
        if (this.config.apiContext.contextLevel < requiredContext ||
            this.config.apiContext.contextLevel === context_1.ApiContextLevel.WAIT_FOR_INIT) {
            throw new context_1.PermitContextError(`You're trying to use an SDK method that requires an API context of ${context_1.ApiContextLevel[requiredContext]}, ` +
                `however the SDK is running in a less specific context level: ${context_1.ApiContextLevel[this.config.apiContext.contextLevel]}.`);
        }
    }
    handleApiError(err) {
        var _a, _b, _c;
        if (axios_1.default.isAxiosError(err)) {
            // this is an http response with an error status code
            const logMessage = `Got error status code: ${(_a = err.response) === null || _a === void 0 ? void 0 : _a.status}, err: ${JSON.stringify((_b = err === null || err === void 0 ? void 0 : err.response) === null || _b === void 0 ? void 0 : _b.data)}`;
            const apiMessage = (_c = err.response) === null || _c === void 0 ? void 0 : _c.data.message;
            // log this to the SDK logger
            this.logger.error(logMessage);
            // and throw a permit error exception
            throw new PermitApiError(apiMessage, err);
        }
        else {
            // unexpected error, just throw
            throw err;
        }
    }
}
exports.BasePermitApi = BasePermitApi;
class BaseFactsPermitAPI extends BasePermitApi {
    constructor(config, logger) {
        super(config, logger);
        this.config = config;
        this.logger = logger;
        if (config.proxyFactsViaPdp) {
            this.openapiClientConfig = new openapi_1.Configuration({
                basePath: `${this.config.pdp}`,
                accessToken: this.config.token,
                baseOptions: {
                    headers: Object.assign(Object.assign(Object.assign({}, this.openapiClientConfig.baseOptions.headers), (this.config.factsSyncTimeout !== null && {
                        'X-Wait-Timeout': this.config.factsSyncTimeout.toString(),
                    })), (this.config.factsSyncTimeoutPolicy && {
                        'X-Timeout-Policy': this.config.factsSyncTimeoutPolicy,
                    })),
                },
            });
        }
    }
    clone() {
        return new this.constructor(this.config, this.logger);
    }
    waitForSync(timeout, policy) {
        if (this.config.proxyFactsViaPdp) {
            const clone = this.clone();
            clone.openapiClientConfig.baseOptions.headers['X-Wait-Timeout'] =
                timeout === null ? '' : timeout.toString();
            const timeoutPolicy = policy || this.config.factsSyncTimeoutPolicy;
            if (timeoutPolicy) {
                clone.openapiClientConfig.baseOptions.headers['X-Timeout-Policy'] = timeoutPolicy;
            }
            return clone;
        }
        else {
            this.logger.warn("Attempted to wait for sync, but 'proxyFactsViaPdp' is not enabled. Ignoring.");
            return this;
        }
    }
}
exports.BaseFactsPermitAPI = BaseFactsPermitAPI;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hcGkvYmFzZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxrREFBeUQ7QUFJekQsd0NBQXVEO0FBQ3ZELDBDQUE0QztBQUU1Qyx1Q0FBZ0c7QUFRaEcsTUFBYSxjQUFrQixTQUFRLEtBQUs7SUFDMUMsWUFBWSxPQUFlLEVBQVMsYUFBNEI7UUFDOUQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRG1CLGtCQUFhLEdBQWIsYUFBYSxDQUFlO0lBRWhFLENBQUM7SUFFRCxJQUFXLG1CQUFtQjs7UUFDNUIsT0FBTztZQUNMLElBQUksRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUk7WUFDN0IsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPO1lBQ3JCLEtBQUssRUFBRSxNQUFBLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSwwQ0FBRSxJQUFJO1lBQ3hDLE1BQU0sRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU07U0FDbEMsQ0FBQztJQUNKLENBQUM7SUFFRCxJQUFXLE9BQU87UUFDaEIsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQztJQUNwQyxDQUFDO0lBRUQsSUFBVyxRQUFRO1FBQ2pCLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUM7SUFDckMsQ0FBQztDQUNGO0FBckJELHdDQXFCQztBQXFDRCxNQUFzQixhQUFhO0lBSWpDLFlBQXNCLE1BQXFCLEVBQVksTUFBYzs7UUFBL0MsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQUFZLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDbkUsTUFBTSxPQUFPLEdBQUcsTUFBQSxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixtQ0FBSSxTQUFTLENBQUM7UUFDN0QsSUFBSSxDQUFDLG1CQUFtQixHQUFHLElBQUksdUJBQWEsQ0FBQztZQUMzQyxRQUFRLEVBQUUsR0FBRyxJQUFJLENBQUMs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